---
title: "New Dominance Definition"
author: "Briana Mittleman"
date: "4/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(workflowr)
library(gridExtra)
library(VennDiagram)
library(tidyverse)
library(cowplot)
```

The way I am calling dominance is a bit naive. I am looking for the most used PAS. It may be better to look for genes with actual dominance on one PAS, meaning a PAS is used X percent above the others in the gene. I will have a set of genes with 1 PAS, 1 domiant PAS, no dominant PAS. I can then look to see if these sets are te same or different across species.  

I wrote a python script. I will test it with a small file.  

```{bash,eval=F}
mkdir ../data/DomDefGreaterX
head -n 1 ../data/PAS_doubleFilter/PAS_5perc_either_HumanCoord_BothUsage_meta_doubleFilter.txt  > ../data/DomDefGreaterX/TestFile_ZSWIM7.txt
grep ZSWIM7 ../data/PAS_doubleFilter/PAS_5perc_either_HumanCoord_BothUsage_meta_doubleFilter.txt >> ../data/DomDefGreaterX/TestFile_ZSWIM7.txt

python FindDomXCutoff.py ../data/DomDefGreaterX/TestFile_ZSWIM7.txt ../data/DomDefGreaterX/TestDom_ZSWIM7.txt .3 Human 
python FindDomXCutoff.py ../data/DomDefGreaterX/TestFile_ZSWIM7.txt ../data/DomDefGreaterX/TestDom_ZSWIM7.txt .3 Chimp 

sbatch runNewDom.sh

```

Looks like this code works for both species. Not the most efficient but fine.  

First I need the set of genes with 1 pas. These will not be included in the analysis. I added to the code to not include PAS that have 0 usage in that species.  

```{r}
MetaPAS=read.table("../data/PAS_doubleFilter/PAS_5perc_either_HumanCoord_BothUsage_meta_doubleFilter.txt", header = T, stringsAsFactors = F)
MetaCol=colnames(MetaPAS)
Human1PASGene= MetaPAS %>% filter(Human>0) %>% group_by(gene) %>% summarise(nPAS=n()) %>% filter(nPAS==1)
Chimp1PASGene= MetaPAS %>% filter(Chimp>0) %>% group_by(gene) %>% summarise(nPAS=n()) %>% filter(nPAS==1)

MetaPAS_human1= MetaPAS %>% filter(gene %in% Human1PASGene$gene, Human >0) %>% mutate(Set="Human1")
MetaPAS_chimp1= MetaPAS %>% filter(gene %in% Chimp1PASGene$gene, Chimp >0)  %>% mutate(Set="Chimp1")

```
Look at where these are.  

```{r}
OnePASboth=MetaPAS_human1 %>% bind_rows(MetaPAS_chimp1)
ggplot(OnePASboth, aes(x=loc, by=Set, fill=Set)) + geom_bar(position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="PAS location for genes with 1 PAS in each species")
```

##Seperate results  
I will run the code at different cutoffs from 10% different to 90% different. I can do this with a bash script.

I need to think about the best way to visualize this. I will start with 1 usage cutoff then move toward more. Start with the most stringent. For each one I will add the number of PAS in the gene origianlly:  

###90% difference 
```{r}
PASnum= MetaPAS %>% select(PAS, gene, Chimp, Human) %>% gather(Species, usage, -PAS, -gene) %>% filter(usage >0) %>% group_by(gene,Species) %>% summarise(nPAS=n())
PASnumHuman=PASnum %>% filter(Species=="Human") %>% select(-Species)
PASnumChimp=PASnum %>% filter(Species=="Chimp") %>% select(-Species)



HumanDom9=read.table("../data/DomDefGreaterX/Human_.9_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human9") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom9)
ChimpDom9=read.table("../data/DomDefGreaterX/Chimp_.9_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp9") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom9)
```


Explore these:  

```{r}
BothDom9=HumanDom9 %>% bind_rows(ChimpDom9)
genloc9=ggplot(BothDom9, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.9",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc9
```

```{r}



BothDom9_prop= BothDom9 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc9=ggplot(BothDom9_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.9",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```



There are way more in chimp at this cutoff. 

Look at how many genes have the same and different dominant at .9 difference:  

```{r}
HumanDom9_sm=HumanDom9 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom9_sm=ChimpDom9 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both9sm=ChimpDom9_sm %>% inner_join(HumanDom9_sm, by="gene")
nrow(both9sm)
```

Look at the number of PAS in these genes:  

None of the same genes are represented here.
```{r}
ggplot(BothDom9, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .9 difference",y="genes")
```

```{r}
grid.newpage()
venn.plot9 <- draw.pairwise.venn(area1 = length(HumanDom9_sm$gene),
                           area2 = length(ChimpDom9_sm$gene),
                           cross.area = nrow(both9sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```
Look at the location of the PAS not in gene.  

```{r}

HumanDom9_smLab= HumanDom9 %>% mutate(Set="Human")
ChimpDom9_smLab= ChimpDom9 %>% mutate(Set="Chimp")
BothDom9_smLab=HumanDom9_smLab %>% bind_rows(ChimpDom9_smLab)
diffgenes9=ggplot(BothDom9_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2")+  labs(title="Non Matched: 0.9", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes9
```

```{r}
BothDom9_smLab_prop=BothDom9_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff9=ggplot(BothDom9_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.9: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```



###80% difference

```{r}
HumanDom8=read.table("../data/DomDefGreaterX/Human_.8_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human8") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom8)
ChimpDom8=read.table("../data/DomDefGreaterX/Chimp_.8_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp8") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom8)

BothDom8=HumanDom8 %>% bind_rows(ChimpDom8)
genloc8=ggplot(BothDom8, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.8",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc8
```

```{r}
HumanDom8_sm=HumanDom8 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom8_sm=ChimpDom8 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both8sm=ChimpDom8_sm %>% inner_join(HumanDom8_sm, by="gene")
nrow(both8sm)
```
There are 192 genes that are the same. 
```{r}
grid.newpage()
venn.plot8 <- draw.pairwise.venn(area1 = length(HumanDom8_sm$gene),
                           area2 = length(ChimpDom8_sm$gene),
                           cross.area = nrow(both8sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```
For these I can look to see if the PAS are the same or different:  

```{r}
both8sm_same= both8sm %>% filter(ChimpPAS==HumanPAS)
nrow(both8sm_same)
both8sm_diff= both8sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both8sm_diff)
```

location for same: 
```{r}
same8=ggplot(both8sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .8", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same8
```




Only 3 are in different PAS

```{r}
both8sm_diff
```
```{r}
ggplot(BothDom8, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .8 difference",y="genes")
```

```{r}
HumanDom8_smLab= HumanDom8 %>% anti_join(ChimpDom8,by = "gene") %>% mutate(Set="Human")
ChimpDom8_smLab=  ChimpDom8 %>% anti_join(HumanDom8,by = "gene") %>% mutate(Set="Chimp")
BothDom8_smLab=HumanDom8_smLab %>% bind_rows(ChimpDom8_smLab)
diffgenes8=ggplot(BothDom8_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +  labs(title="Non Matched: 0.8", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes8
```

```{r}

BothDom8_prop= BothDom8 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc8=ggplot(BothDom8_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.8",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```


```{r}
BothDom8_smLab_prop=BothDom8_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff8=ggplot(BothDom8_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.8: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```

###70% difference  


```{r}
HumanDom7=read.table("../data/DomDefGreaterX/Human_.7_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human7") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom7)
ChimpDom7=read.table("../data/DomDefGreaterX/Chimp_.7_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp7") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom7)

BothDom7=HumanDom7 %>% bind_rows(ChimpDom7)
genloc7=ggplot(BothDom7, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.7",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc7
```

```{r}
HumanDom7_sm=HumanDom7 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom7_sm=ChimpDom7 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both7sm=ChimpDom7_sm %>% inner_join(HumanDom7_sm, by="gene")
nrow(both7sm)
```

```{r}
grid.newpage()
venn.plot7 <- draw.pairwise.venn(area1 = length(HumanDom7_sm$gene),
                           area2 = length(ChimpDom7_sm$gene),
                           cross.area = nrow(both7sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```

```{r}
both7sm_same= both7sm %>% filter(ChimpPAS==HumanPAS)
nrow(both7sm_same)
both7sm_diff= both7sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both7sm_diff)
```

location for same: 
```{r}
same7=ggplot(both7sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .7", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same7
```
```{r}
both7sm_diff
```
```{r}
ggplot(BothDom7, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .7 difference",y="genes")
```
```{r}
HumanDom7_smLab= HumanDom7 %>% anti_join(ChimpDom7,by = "gene") %>% mutate(Set="Human")
ChimpDom7_smLab=  ChimpDom7 %>% anti_join(HumanDom7,by = "gene") %>% mutate(Set="Chimp")
BothDom7_smLab=HumanDom7_smLab %>% bind_rows(ChimpDom7_smLab)
diffgenes7=ggplot(BothDom7_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Location of dominant PAS in genes \nnot matched between species: 0.7", y="genes")+  labs(title="Non Matched: 0.7", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes7
```

```{r}

BothDom7_prop= BothDom7 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc7=ggplot(BothDom7_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.7",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```



```{r}
BothDom7_smLab_prop=BothDom7_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff7=ggplot(BothDom7_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.7: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
###60% difference  


```{r}
HumanDom6=read.table("../data/DomDefGreaterX/Human_.6_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human6") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom6)
ChimpDom6=read.table("../data/DomDefGreaterX/Chimp_.6_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp6") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom6)

BothDom6=HumanDom6 %>% bind_rows(ChimpDom6)
genloc6=ggplot(BothDom6, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.6",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc6
```
```{r}
HumanDom6_sm=HumanDom6 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom6_sm=ChimpDom6 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both6sm=ChimpDom6_sm %>% inner_join(HumanDom6_sm, by="gene")
nrow(both6sm)
```

```{r}
grid.newpage()
venn.plot6 <- draw.pairwise.venn(area1 = length(HumanDom6_sm$gene),
                           area2 = length(ChimpDom6_sm$gene),
                           cross.area = nrow(both6sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```

```{r}
both6sm_same= both6sm %>% filter(ChimpPAS==HumanPAS)
nrow(both6sm_same)
both6sm_diff= both6sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both6sm_diff)
```

location for same: 
```{r}
same6=ggplot(both6sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .6", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same6
```
```{r}
both6sm_diff
```
```{r}
ggplot(BothDom6, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .6 difference",y="genes")
```
```{r}
HumanDom6_smLab= HumanDom6 %>% anti_join(ChimpDom6,by = "gene") %>% mutate(Set="Human")
ChimpDom6_smLab=  ChimpDom6 %>% anti_join(HumanDom6,by = "gene") %>% mutate(Set="Chimp")
BothDom6_smLab=HumanDom6_smLab %>% bind_rows(ChimpDom6_smLab)
diffgenes6=ggplot(BothDom6_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +  labs(title="Non Matched: 0.6", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes6
```

```{r}

BothDom6_prop= BothDom6 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc6=ggplot(BothDom6_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.6",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```



```{r}
BothDom6_smLab_prop=BothDom6_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff6=ggplot(BothDom6_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.6: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
###50% difference  



```{r}
HumanDom5=read.table("../data/DomDefGreaterX/Human_.5_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human5") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom5)
ChimpDom5=read.table("../data/DomDefGreaterX/Chimp_.5_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp5") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom5)

BothDom5=HumanDom5 %>% bind_rows(ChimpDom5)
genloc5=ggplot(BothDom5, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.5",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc5
```
```{r}
HumanDom5_sm=HumanDom5 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom5_sm=ChimpDom5 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both5sm=ChimpDom5_sm %>% inner_join(HumanDom5_sm, by="gene")
nrow(both5sm)
```

```{r}
grid.newpage()
venn.plot5 <- draw.pairwise.venn(area1 = length(HumanDom5_sm$gene),
                           area2 = length(ChimpDom5_sm$gene),
                           cross.area = nrow(both5sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```

```{r}
both5sm_same= both5sm %>% filter(ChimpPAS==HumanPAS)
nrow(both5sm_same)
both5sm_diff= both5sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both5sm_diff)
```

location for same: 
```{r}
same5=ggplot(both5sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .5", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same5
```

```{r}
both5sm_diff
```
```{r}
ggplot(BothDom5, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .5 difference",y="genes")
```
```{r}
HumanDom5_smLab= HumanDom5 %>% anti_join(ChimpDom5,by = "gene") %>% mutate(Set="Human")
ChimpDom5_smLab=  ChimpDom5 %>% anti_join(HumanDom5,by = "gene") %>% mutate(Set="Chimp")
BothDom5_smLab=HumanDom5_smLab %>% bind_rows(ChimpDom5_smLab)
diffgenes5=ggplot(BothDom5_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +   labs(title="Non Matched: 0.5", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes5
```


```{r}

BothDom5_prop= BothDom5 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc5=ggplot(BothDom5_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.5",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```


```{r}
BothDom5_smLab_prop=BothDom5_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff5=ggplot(BothDom5_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.5: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
###40% difference  


```{r}
HumanDom4=read.table("../data/DomDefGreaterX/Human_.4_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human4") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom4)
ChimpDom4=read.table("../data/DomDefGreaterX/Chimp_.4_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp4") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom4)

BothDom4=HumanDom4 %>% bind_rows(ChimpDom4)
genloc4=ggplot(BothDom4, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.4",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc4
```

```{r}
HumanDom4_sm=HumanDom4 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom4_sm=ChimpDom4 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both4sm=ChimpDom4_sm %>% inner_join(HumanDom4_sm, by="gene")
nrow(both4sm)
```
```{r}
grid.newpage()
venn.plot4 <- draw.pairwise.venn(area1 = length(HumanDom4_sm$gene),
                           area2 = length(ChimpDom4_sm$gene),
                           cross.area = nrow(both4sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```
```{r}
both4sm_same= both4sm %>% filter(ChimpPAS==HumanPAS)
nrow(both4sm_same)
both4sm_diff= both4sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both4sm_diff)
```

location for same: 
```{r}
same4=ggplot(both4sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .4", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same4
```
22 is enough to start to plot:  

```{r}
both4sm_diff_g= both4sm_diff %>% select(gene, HumanLoc, ChimpLoc) %>% gather('Species', 'Loc', -gene)
diffDom4=ggplot(both4sm_diff_g, aes(x=Loc, fill=Species))+ geom_bar(stat="count",position = "dodge") +scale_fill_brewer(palette = "Dark2")+ labs(y='Genes', title="Different Dominant PAS: 0.4",x="") +theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffDom4
```
```{r}
ggplot(BothDom4, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .4 difference",y="genes")
```

```{r}
HumanDom4_smLab= HumanDom4 %>% anti_join(ChimpDom4,by = "gene") %>% mutate(Set="Human")
ChimpDom4_smLab=  ChimpDom4 %>% anti_join(HumanDom4,by = "gene") %>% mutate(Set="Chimp")
BothDom4_smLab=HumanDom4_smLab %>% bind_rows(ChimpDom4_smLab)
diffgenes4=ggplot(BothDom4_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +  labs(title="Non Matched: 0.4", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes4
```

```{r}

BothDom4_prop= BothDom4 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc4=ggplot(BothDom4_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.4",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```


```{r}
BothDom4_smLab_prop=BothDom4_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff4=ggplot(BothDom4_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.4: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
###30% difference  


```{r}
HumanDom3=read.table("../data/DomDefGreaterX/Human_.3_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human3") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom3)
ChimpDom3=read.table("../data/DomDefGreaterX/Chimp_.3_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp3") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom3)

BothDom3=HumanDom3 %>% bind_rows(ChimpDom3)
genloc3=ggplot(BothDom3, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.3",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc3
```


```{r}
HumanDom3_sm=HumanDom3 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom3_sm=ChimpDom3 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both3sm=ChimpDom3_sm %>% inner_join(HumanDom3_sm, by="gene")
nrow(both3sm)
```
```{r}
grid.newpage()
venn.plot3 <- draw.pairwise.venn(area1 = length(HumanDom3_sm$gene),
                           area2 = length(ChimpDom3_sm$gene),
                           cross.area = nrow(both3sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```
```{r}
both3sm_same= both3sm %>% filter(ChimpPAS==HumanPAS)
nrow(both3sm_same)
both3sm_diff= both3sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both3sm_diff)
```

location for same: 
```{r}
same3=ggplot(both3sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .3", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same3
```

```{r}
both3sm_diff_g= both3sm_diff %>% select(gene, HumanLoc, ChimpLoc) %>% gather('Species', 'Loc', -gene)
diffDom3=ggplot(both3sm_diff_g, aes(x=Loc, fill=Species))+ geom_bar(stat="count",position = "dodge") +scale_fill_brewer(palette = "Dark2")+ labs(y='Genes', title="Different Dominant PAS: 0.3",x="") +theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffDom3
```

```{r}
ggplot(BothDom3, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .3 difference",y="genes")
```
```{r}
HumanDom3_smLab= HumanDom3 %>% anti_join(ChimpDom3,by = "gene") %>% mutate(Set="Human")
ChimpDom3_smLab=  ChimpDom3 %>% anti_join(HumanDom3,by = "gene") %>% mutate(Set="Chimp")
BothDom3_smLab=HumanDom3_smLab %>% bind_rows(ChimpDom3_smLab)
diffgenes3=ggplot(BothDom3_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +   labs(title="Non Matched: 0.3", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes3
```


```{r}

BothDom3_prop= BothDom3 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc3=ggplot(BothDom3_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.3",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```

```{r}

BothDom3_prop= BothDom3 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc3=ggplot(BothDom3_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.3",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```


```{r}
BothDom3_smLab_prop=BothDom3_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff3=ggplot(BothDom3_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.3: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
###20% difference  


```{r}
HumanDom2=read.table("../data/DomDefGreaterX/Human_.2_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human2") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom2)
ChimpDom2=read.table("../data/DomDefGreaterX/Chimp_.2_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp2") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom2)

BothDom2=HumanDom2 %>% bind_rows(ChimpDom2)
genloc2=ggplot(BothDom2, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.2",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
genloc2
```


```{r}
HumanDom2_sm=HumanDom2 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom2_sm=ChimpDom2 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both2sm=ChimpDom2_sm %>% inner_join(HumanDom2_sm, by="gene")
nrow(both2sm)
```
```{r}
grid.newpage()
venn.plot2 <- draw.pairwise.venn(area1 = length(HumanDom2_sm$gene),
                           area2 = length(ChimpDom2_sm$gene),
                           cross.area = nrow(both2sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```
```{r}
both2sm_same= both2sm %>% filter(ChimpPAS==HumanPAS)
nrow(both2sm_same)
both2sm_diff= both2sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both2sm_diff)
```
location for same: 
```{r}
same2=ggplot(both2sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .2", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same2
```
```{r}
both2sm_diff_g= both2sm_diff %>% select(gene, HumanLoc, ChimpLoc) %>% gather('Species', 'Loc', -gene)
diffDom2=ggplot(both2sm_diff_g, aes(x=Loc, fill=Species))+ geom_bar(stat="count",position = "dodge") +scale_fill_brewer(palette = "Dark2")+  labs(y='Genes', title="Different Dominant PAS: 0.2",x="") +theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffDom2
```
```{r}
ggplot(BothDom2, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .2 difference",y="genes")
```
```{r}
HumanDom2_smLab= HumanDom2 %>% anti_join(ChimpDom2,by = "gene") %>% mutate(Set="Human")
ChimpDom2_smLab=  ChimpDom2 %>% anti_join(HumanDom2,by = "gene") %>% mutate(Set="Chimp")
BothDom2_smLab=HumanDom2_smLab %>% bind_rows(ChimpDom2_smLab)
diffgenes2=ggplot(BothDom2_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +  labs(title="Non Matched: 0.2", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes2
```


```{r}

BothDom2_prop= BothDom2 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc2=ggplot(BothDom2_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.2",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```


```{r}
BothDom2_smLab_prop=BothDom2_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff2=ggplot(BothDom2_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.2: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
###10% difference  


```{r}
HumanDom1=read.table("../data/DomDefGreaterX/Human_.1_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Human1") %>% inner_join(PASnumHuman, by="gene")
nrow(HumanDom1)
ChimpDom1=read.table("../data/DomDefGreaterX/Chimp_.1_dominantPAS.txt", col.names = MetaCol,stringsAsFactors = F) %>% mutate(set="Chimp1") %>% inner_join(PASnumChimp, by="gene")
nrow(ChimpDom1)

BothDom1=HumanDom1 %>% bind_rows(ChimpDom1)
genloc1=ggplot(BothDom1, aes(x=loc, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.1",y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none") 

genloc1
```

```{r}
HumanDom1_sm=HumanDom1 %>% select(PAS, gene, loc) %>% rename(HumanPAS=PAS, HumanLoc=loc)
ChimpDom1_sm=ChimpDom1 %>% select(PAS, gene, loc)%>% rename(ChimpPAS=PAS, ChimpLoc=loc)

both1sm=ChimpDom1_sm %>% inner_join(HumanDom1_sm, by="gene")
nrow(both1sm)
```
```{r}
grid.newpage()
venn.plot1 <- draw.pairwise.venn(area1 = length(HumanDom1_sm$gene),
                           area2 = length(ChimpDom1_sm$gene),
                           cross.area = nrow(both1sm),
                           c("Human", "Chimp"), scaled = TRUE,
                           fill = c("orange", "green"),
                           cex = 1.5,
                           cat.cex = 1.5,
                           cat.pos = c(320, 25),
                           cat.dist = .05) 
```
```{r}
both1sm_same= both1sm %>% filter(ChimpPAS==HumanPAS)
nrow(both1sm_same)
both1sm_diff= both1sm %>% filter(ChimpPAS!=HumanPAS)
nrow(both1sm_diff)
```
location for same: 
```{r}
same1=ggplot(both1sm_same,aes(x=ChimpLoc,fill=ChimpLoc)) +geom_bar(stat = "count") +scale_fill_brewer(palette = "Dark2")+ labs(title="Matched Gene Matched PAS .1", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
same1
```
```{r}
both1sm_diff_g= both1sm_diff %>% select(gene, HumanLoc, ChimpLoc) %>% gather('Species', 'Loc', -gene)
diffDom1=ggplot(both1sm_diff_g, aes(x=Loc, fill=Species))+ geom_bar(stat="count",position = "dodge") +scale_fill_brewer(palette = "Dark2")+ labs(y='PAS', title="Location for Different Dominant PAS at 10% difference") +labs(y='Genes', title="Different Dominant PAS: 0.1",x="") +theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffDom1
```

```{r}

ggplot(BothDom1, aes(x=nPAS, fill=set)) + geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of PAS per gene with .1 difference",y="genes")
```


```{r}
HumanDom1_smLab= HumanDom1 %>% anti_join(ChimpDom1,by = "gene") %>% mutate(Set="Human")
ChimpDom1_smLab=  ChimpDom1 %>% anti_join(HumanDom1,by = "gene") %>% mutate(Set="Chimp")
BothDom1_smLab=HumanDom1_smLab %>% bind_rows(ChimpDom1_smLab)
diffgenes1=ggplot(BothDom1_smLab,aes(x=loc, fill=Set))+ geom_bar(stat="count", position = "dodge") + scale_fill_brewer(palette = "Dark2") +  labs(title="Non Matched: 0.1", y="genes",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
diffgenes1
```


```{r}

BothDom1_prop= BothDom1 %>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)

proploc1=ggplot(BothDom1_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.1",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```



```{r}
BothDom1_smLab_prop=BothDom1_smLab%>% group_by(set, loc) %>% summarise(nLoc=n()) %>% ungroup() %>% group_by(set) %>% mutate(nSet=sum(nLoc), prop=nLoc/nSet)
propDiff1=ggplot(BothDom1_smLab_prop, aes(x=loc,by=set, fill=set,y=prop)) + geom_bar(stat="identity",position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="0.1: Different Genes",y="Proportion",x="")+theme(axis.text.x = element_text(angle = 90),legend.position = "none")
```
##Aggregate results:  

Next step will be to aggregate these plots in a way that is both easier to visualize but also easier to draw conclusions from.  

First plot the number of genes with a dominant PAS at each cutoff. 

```{r}
Cutoffs=seq(0.1,.9, .1)
Human=c(nrow(HumanDom1),nrow(HumanDom2),nrow(HumanDom3),nrow(HumanDom4),nrow(HumanDom5),nrow(HumanDom6),nrow(HumanDom7),nrow(HumanDom8),nrow(HumanDom9))
Chimp=c(nrow(ChimpDom1),nrow(ChimpDom2),nrow(ChimpDom3),nrow(ChimpDom4),nrow(ChimpDom5),nrow(ChimpDom6),nrow(ChimpDom7),nrow(ChimpDom8),nrow(ChimpDom9))

DomNumsDF=as.data.frame(cbind(Cutoffs, Human, Chimp)) %>% gather("Species", "DominantGenes", -Cutoffs)
DomNumsDF$Cutoffs= as.factor(DomNumsDF$Cutoffs)
ggplot(DomNumsDF, aes(x=Cutoffs, fill=Species, y=DominantGenes)) + geom_bar(stat="identity", position = "dodge") + scale_fill_brewer(palette = "Dark2") + labs(title="Number of Genes with a Dominant PAS",x="Difference in usage to be called dominant")
```

General location: 

```{r}
genloctiles <- ggdraw() + 
  draw_label(
    "Location of Dominant PAS",
    fontface = 'bold',
    x = 0,
    hjust = 0
  )
genloc=plot_grid(genloc1,genloc2,genloc3,genloc4,genloc5,genloc6,genloc7,genloc8,genloc9)

plot_grid(
  genloctiles, genloc,
  ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1)
)
```

This shows this pattern is robust to the cutoff.  


Proportion: 

```{r}


proploctiles <- ggdraw() + 
  draw_label(
    "Location of Dominant PAS by proportion",
    fontface = 'bold',
    x = 0,
    hjust = 0
  )
proploc=plot_grid(proploc9,proploc8,proploc7,proploc6,proploc5,proploc4,proploc3,proploc2,proploc1)

plot_grid(
  proploctiles, proploc,
  ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1)
)
```




Plot the joint genes.  

```{r}
diffdomtiles <- ggdraw() + 
  draw_label(
    "Location of Dominant PAS in genes with different Dominant PAS",
    fontface = 'bold',
    x = 0,
    hjust = 0
  )
diffdom=plot_grid(diffDom1,diffDom2,diffDom3,diffDom4)

plot_grid(
  diffdomtiles, diffdom,
  ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1)
)
```

This is also robust to cutoff.  


Location when they do not share the same gene.  

diffgenes9 

```{r}
diffgenestiles <- ggdraw() + 
  draw_label(
    "Location of Dominant PAS in genes with a dominant PAS only in 1 species",
    fontface = 'bold',
    x = 0,
    hjust = 0
  )
diffgenes=plot_grid(diffgenes1,diffgenes2,diffgenes3,diffgenes4,diffgenes5,diffgenes6,diffgenes7,diffgenes8,diffgenes9)

plot_grid(
  diffgenestiles, diffgenes,
  ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1)
)
```


```{r}
#propDiff1
diffgenesProptiles <- ggdraw() + 
  draw_label(
    "Location of Dominant PAS in genes with a dominant PAS only in 1 species- Proportion",
    fontface = 'bold',
    x = 0,
    hjust = 0
  )
diffPropgenes=plot_grid(propDiff1,propDiff2,propDiff3,propDiff4,propDiff5,propDiff6,propDiff7,propDiff8,propDiff9)

plot_grid(
  diffgenesProptiles, diffPropgenes,
  ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1)
)
```


This is robust as well.  


Look at the overlapping genes with the same PAS  

```{r}
#same1

SAMESAMEtiles <- ggdraw() + 
  draw_label(
    "Location of Dominant PAS in genes with the same dominant PAS",
    fontface = 'bold',
    x = 0,
    hjust = 0
  )
SAMESAME=plot_grid(same1,same2,same3,same4,same5,same6,same7,same8)

plot_grid(
  SAMESAMEtiles, SAMESAME,
  ncol = 1,
  # rel_heights values control vertical title margins
  rel_heights = c(0.1, 1)
)
```


